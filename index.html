<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <!-- Bootstrap -->
    <link href="https://fonts.googleapis.com/css?family=Questrial" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style>
        body {
            font-family: 'Josefin Sans', sans-serif;
        }

        .form-horizontal {
            background-color: #41d97c;
        }

        .row {
            background-color: #63ffbc;
        }
    </style>
    <title>BattleTank</title>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8">
                <div class="flip">
                    <div class="card">
                        <div class="face front">
                            <div class="panel panel-default">
                                <div class="row">
                                    <h3 class="text-center">Battle Tank by Ricardo PÃ©rez</h3>
                                    <div class="col-md-6 formColor">
                                        <form class="form-horizontal" id="signUp">
                                            <hr>
                                            <h4 class="text-center">Sign Up</h4>
                                            <input class="form-control" placeholder="Username" id="newUsername" />
                                            <input class="form-control" placeholder="Password" id="newPassword" />
                                            <input type="submit" name="sub" value="SIGN UP" class="btn btn-primary btn-block" />
                                        </form>
                                        <form class="form-horizontal" id="signIn">
                                            <hr>
                                            <h4 class="text-center">Sign In</h4>
                                            <input class="form-control" placeholder="Username" id="username" />
                                            <input class="form-control" placeholder="Password" id="password" />
                                            <input type="submit" name="sub" value="LOG IN" class="btn btn-primary btn-block" />
                                            <hr>
                                        </form>
                                    </div>
                                    <div class="col-md-6">
                                        <form class="form-horizontal" id="signToken">
                                            <hr>
                                            <h4 class="text-center">Sign in with Token</h4>
                                            <h5>Token</h5>
                                            <input class="form-control" placeholder="TOKEN" id="token" />
                                            <input type="submit" name="sub" value="TOKEN" class="btn btn-primary btn-block" />
                                        </form>
                                        <form class="form-horizontal" id="signWithSocialNetworks">
                                            <hr>
                                            <h4 class="text-center">Sign in with </h4>
                                            <p><i class="fa fa-facebook-f fa-lg"></i><i class="fa fa-twitter fa-lg"></i></p>
                                            <hr>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-2"></div>
        </div>
    </div>
    <!-- /.container -->
    <script>
        $("#signUp").submit(function(event) {
            var newUsername = $("#newUsername").val();
            var newPassword = $("#newPassword").val();
            event.preventDefault();
            $.ajax({
                type: "POST",
                url: "http://192.168.0.15:5000/api/users",
                contentType: "application/json",
                data: JSON.stringify({
                    'username': newUsername,
                    'password': newPassword
                }, null, '\t'),
                accepts: "application/json",
                dataType: 'json',
                success: function(data) {
                    $("#signUp")[0].reset();
                    alert('Registered user! Hi ' + data.username + '!');
                },
                error: function(jqXHR, textStatus) {
                    console.log("ERROR = " + jqXHR.status);
                    $("#signUp")[0].reset();
                }
            });
        });

    </script>
    <script>
        $("#signIn").submit(function(event) {
            //alert("Handler for .submit() called.");
            var username = $("#username").val();
            var password = $("#password").val();
            //console.log(username);
            //console.log(password);
            event.preventDefault();
            $.ajax({
                type: "GET",
                url: "http://192.168.0.15:5000/api/resource",
                contentType: "application/json",
                accepts: "application/json",
                dataType: 'json',
                beforeSend: function(req) {
                    req.setRequestHeader('Authorization', 'Basic ' + btoa(username + ":" + password));
                },
                success: function(data) {
                    $("#signIn")[0].reset();
                    alert(data.data);
                },
                error: function(jqXHR, textStatus) {
                    console.log("ERROR = " + jqXHR.status);
                    $("#signIn")[0].reset();
                }
            });
        });

    </script>
</body>
